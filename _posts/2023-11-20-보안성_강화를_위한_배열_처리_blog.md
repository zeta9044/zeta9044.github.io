---
layout: post
title: "보안성 강화를 위한 배열 처리"
tags: [보안, 처리, 배열, 강화, 위]
---

## 사용자 입력:
> 자바소스 취약점 검사를 했는데, 검사내용이 아래와 같아. 어떻게 해야해? public static final 배열 사용 체커는 public static final 변경자가 지정된 배열 필드 선언을 검출합니다.

## ChatGPT 응답:
> 자바 소스 코드에서 {% raw %}`public static final`{% endraw %} 배열을 사용하는 것은 보안상의 취약점을 일으킬 수 있습니다. 이는 {% raw %}`public static final`{% endraw %}로 선언된 배열이 변경 불가능한 것처럼 보이지만, 실제로는 배열의 내용이 변경될 수 있기 때문입니다. 이를 해결하기 위한 몇 가지 방법이 있습니다:

1. **불변 컬렉션 사용:** {% raw %}`Collections.unmodifiableList()`{% endraw %} 같은 불변 컬렉션을 사용하여 배열을 래핑합니다. 이 방법은 배열의 내용이 외부에서 수정되는 것을 방지할 수 있습니다.

2. **개별 접근 메소드 제공:** 배열 대신 개별 요소에 접근할 수 있는 메소드를 제공합니다. 이 방법은 배열 자체를 숨기고 요소에 접근할 수 있는 제어된 방법을 제공합니다.

3. **방어적 복사 사용:** 배열의 공개적인 접근이 필요한 경우, 원본 배열의 복사본을 반환합니다. 이렇게 하면 외부에서 배열의 복사본을 수정하더라도 원본 배열은 영향을 받지 않습니다.

4. **Enum 사용:** 가능한 경우, 배열 대신 Enum 타입을 사용합니다. Enum은 자바에서 불변으로 취급되므로, 보안상 더 안전할 수 있습니다.

이러한 방법들을 적용함으로써, 코드의 보안성을 강화하고, {% raw %}`public static final`{% endraw %} 배열을 사용함으로 인한 취약점을 줄일 수 있습니다. 코드에 맞는 방법을 선택하여 적용해 보세요.

## 사용자 입력:
> 변경 불가능한 배열로 인식할려는게 아니라, 변수명을 다른 데서 못 사용하게 할려고 쓰는 final 인데..static때문에 문제인가?

## ChatGPT 응답:
> 아, 이해했습니다. 여기서 주요 문제는 {% raw %}`final`{% endraw %} 키워드가 아니라 {% raw %}`static`{% endraw %} 키워드와 관련이 있습니다. {% raw %}`public static final`{% endraw %} 배열은 클래스 레벨에서 선언되며, 프로그램 내 어디서나 접근할 수 있습니다. 이것이 보안상의 취약점을 일으킬 수 있는 이유입니다.

{% raw %}`final`{% endraw %}은 변수가 한 번 초기화되면 그 값을 변경할 수 없게 만드는 것을 의미합니다. 그러나 배열의 경우, {% raw %}`final`{% endraw %}은 배열 자체의 참조를 변경할 수 없다는 것을 의미하지, 배열 내의 개별 요소들이 변경 불가능하다는 것을 의미하지는 않습니다. 즉, 배열의 참조는 변경할 수 없지만 배열 내의 요소들은 변경할 수 있습니다.

{% raw %}`static`{% endraw %} 키워드는 해당 변수가 클래스 인스턴스에 속하지 않고 클래스 자체에 속함을 의미합니다. 이는 모든 인스턴스가 같은 {% raw %}`static`{% endraw %} 변수를 공유한다는 것을 의미하며, 이로 인해 여러 부작용이 발생할 수 있습니다. 특히, 멀티스레드 환경에서는 {% raw %}`static`{% endraw %} 배열이 여러 스레드에 의해 동시에 액세스되고 수정될 수 있어 데이터 무결성 문제가 발생할 수 있습니다.

따라서, {% raw %}`public static final`{% endraw %} 배열을 사용할 때는 다음과 같은 조치를 고려해야 합니다:

1. **배열 대신 불변 컬렉션 사용:** 배열 대신 {% raw %}`Collections.unmodifiableList`{% endraw %} 같은 불변 컬렉션을 사용하여 데이터의 무결성을 유지합니다.

2. **스레드 안전성 고려:** 멀티스레드 환경에서 {% raw %}`static`{% endraw %} 변수를 사용할 때는 스레드 안전성을 고려해야 합니다. 필요한 경우 동기화 메커니즘을 사용하여 동시 접근 문제를 해결할 수 있습니다.

{% raw %}`static`{% endraw %}을 사용하는 주된 이유는 해당 변수가 메모리에 단 한 번만 할당되어야 하거나, 클래스의 모든 인스턴스가 공유해야 하는 경우입니다. 이러한 요구 사항이 없다면, {% raw %}`static`{% endraw %} 사용을 피하는 것이 좋습니다.

